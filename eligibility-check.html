<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check Eligibility - GrantSetu</title>
    <meta name="description" content="Check your eligibility for government schemes and incentives. Get instant results and expert guidance for your MSME applications.">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/main.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="assets/images/grantsetu-logo.svg">
</head>
<body>
    <!-- Navigation Container -->
    <div id="navbar-container"></div>

    <!-- Hero Section -->
    <section class="eligibility-hero section--dark">
        <div class="container">
            <div class="eligibility-hero__content">
                <h1 class="eligibility-hero__title">Haryana based MSMEs are eligible for upto Rs. 25cr incentives & subsidies</h1>
                <h4 class="eligibility-hero__subtitle">Check how much are you eligible for</h4>
            </div>
        </div>
    </section>

    <main class="eligibility-main">
        <div class="container">

            <!-- Flow Map -->
            <!-- <div class="flow-map">
                <div class="flow-step active">
                    <div class="flow-step__icon">
                        <i class="fas fa-edit"></i>
                    </div>
                    <div class="flow-step__content">
                        <h3>Fill Details</h3>
                    </div>
                </div>
                <div class="flow-step">
                    <div class="flow-step__icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="flow-step__content">
                        <h3>Check Eligibility</h3>
                    </div>
                </div>
                <div class="flow-step">
                    <div class="flow-step__icon">
                        <i class="fas fa-download"></i>
                    </div>
                    <div class="flow-step__content">
                        <h3>Download Roadmap</h3>
                    </div>
                </div>
            </div> -->


            <!-- Eligibility Questionnaire -->
            <div id="eligibility-modal" class="eligibility-questionnaire-container">
                <form class="questionnaire-form">
                    
                    <!-- Company Information -->
                    <div class="form-section">
                        <h3>Step 1 of 3: Basic Details</h3>
                        
                        <div class="form-group">
                            <label for="msme-registered">Registered with MSME? *</label>
                            <div class="radio-group">
                                <input type="radio" id="msme-yes" name="msme-registered" value="yes" required>
                                <label for="msme-yes">Yes</label>
                                <input type="radio" id="msme-no" name="msme-registered" value="no" required>
                                <label for="msme-no">No</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="company-name">Registered Company Name *</label>
                            <input type="text" id="company-name" name="company-name" required>
                        </div>

                        <div class="form-group">
                            <label for="company-state">Company registered in which state? *</label>
                            <select id="company-state" name="company-state" required>
                                <option value="">Select State</option>
                                <option value="haryana">Haryana</option>
                                <option value="delhi">Delhi</option>
                                <option value="punjab">Punjab</option>
                                <option value="rajasthan">Rajasthan</option>
                                <option value="uttar-pradesh">Uttar Pradesh</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="directors-partners">Number of Directors / Partners *</label>
                            <div class="number-input-group">
                                <input type="number" id="directors-partners" name="directors-partners" value="1" min="1" max="9" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="women-directors-equity">Do women directors own >51% equity? *</label>
                            <div class="radio-group">
                                <input type="radio" id="women-yes" name="women-directors-equity" value="yes" required>
                                <label for="women-yes">Yes</label>
                                <input type="radio" id="women-no" name="women-directors-equity" value="no" required>
                                <label for="women-no">No</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="sc-st-directors-equity">Do SC/ST directors own >51% equity? *</label>
                            <div class="radio-group">
                                <input type="radio" id="sc-st-yes" name="sc-st-directors-equity" value="yes" required>
                                <label for="sc-st-yes">Yes</label>
                                <input type="radio" id="sc-st-no" name="sc-st-directors-equity" value="no" required>
                                <label for="sc-st-no">No</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="domestic-turnover-fy24-25">Domestic Turnover in IT Returns FY24-25 *</label>
                            <select id="domestic-turnover-fy24-25" name="domestic-turnover-fy24-25" required>
                                <option value="">Select Turnover Slab</option>
                                <option value="micro">Up to â‚¹5 Crores (Micro)</option>
                                <option value="small">â‚¹5 Crores to â‚¹75 Crores (Small)</option>
                                <option value="medium">â‚¹75 Crores to â‚¹250 Crores (Medium)</option>
                                <option value="large">Above â‚¹250 Crores (Large)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="primary-sector">Which Sector do you operate in? *</label>
                            <select id="primary-sector" name="primary-sector" required>
                                <option value="">Select Primary Sector</option>
                                <option value="textile">Textile & Apparel</option>
                                <option value="food-processing">Food Processing</option>
                                <option value="renewable-energy">Renewable Energy</option>
                                <option value="ict">Information & Communication Technology</option>
                                <option value="traditional">Traditional Industries</option>
                                <option value="general">General Manufacturing</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="operational-manufacturing-units">Number of Operational Manufacturing Units *</label>
                            <div class="number-input-group">
                                <input type="number" id="operational-manufacturing-units" name="operational-manufacturing-units" value="1" min="1" max="9" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="upcoming-manufacturing-units">Number of upcoming manufacturing units</label>
                            <div class="number-input-group">
                                <input type="number" id="upcoming-manufacturing-units" name="upcoming-manufacturing-units" value="0" min="0" max="9">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="startup-status">Are you a DPIIT Recognized Startup?</label>
                            <div class="radio-group">
                                <input type="radio" id="startup-yes" name="startup-status" value="yes">
                                <label for="startup-yes">Yes</label>
                                <input type="radio" id="startup-no" name="startup-status" value="no">
                                <label for="startup-no">No</label>
                                <input type="radio" id="startup-applied" name="startup-status" value="applied">
                                <label for="startup-applied">Applied</label>
                            </div>
                            <small>For startup-specific and DPIIT recognized startup schemes</small>
                        </div>

                        <div class="form-group">
                            <label for="requires-listing">Have you filed for SME IPO?</label>
                            <div class="radio-group">
                                <input type="radio" id="sme-ipo-yes" name="requires-listing" value="true">
                                <label for="sme-ipo-yes">Yes</label>
                                <input type="radio" id="sme-ipo-no" name="requires-listing" value="false">
                                <label for="sme-ipo-no">No</label>
                            </div>
                            <small>Required for SME Exchange Equity Scheme</small>
                        </div>
                    <!-- <h3>Applicant's Information</h3> -->
                        
                        <div class="form-group">
                            <label for="applicant-name">You Name *</label>
                            <input type="text" id="applicant-name" name="applicant-name" required>
                            <!-- <small>Full name of the applicant</small> -->
                        </div>

                        <div class="form-group">
                            <label for="applicant-role">Your Role *</label>
                            <select id="applicant-role" name="applicant-role" required>
                                <option value="">Select Role</option>
                                <option value="director">Director</option>
                                <option value="cfo">CFO</option>
                                <option value="other">Other</option>
                            </select>
                            <!-- <small>Your role in the company</small> -->
                        </div>

                        <div class="form-group">
                            <label for="applicant-phone">Whatsapp Number *</label>
                            <input type="tel" id="applicant-phone" name="applicant-phone" required>
                            <!-- <small>Contact number for communication</small> -->
                        </div>
                    </div>

                    <!-- Project Information -->
                    <div class="form-section" style="display: none;">
                        <h3>Project Information</h3>
                        
                        <div class="form-group">
                            <label for="district">Where is your Unit Located in Haryana *</label>
                            <select id="district" name="district" onchange="updateBlocks()">
                                <option value="">Select District</option>
                                <option value="ambala">Ambala</option>
                                <option value="bhiwani">Bhiwani</option>
                                <option value="charkhi-dadri">Charkhi Dadri</option>
                                <option value="faridabad">Faridabad</option>
                                <option value="fatehabad">Fatehabad</option>
                                <option value="gurugram">Gurugram</option>
                                <option value="hisar">Hisar</option>
                                <option value="jhajjar">Jhajjar</option>
                                <option value="jind">Jind</option>
                                <option value="kaithal">Kaithal</option>
                                <option value="karnal">Karnal</option>
                                <option value="kurukshetra">Kurukshetra</option>
                                <option value="mahendragarh">Mahendragarh</option>
                                <option value="mewat">Mewat</option>
                                <option value="palwal">Palwal</option>
                                <option value="panchkula">Panchkula</option>
                                <option value="panipat">Panipat</option>
                                <option value="rewari">Rewari</option>
                                <option value="rohtak">Rohtak</option>
                                <option value="sirsa">Sirsa</option>
                                <option value="sonipat">Sonipat</option>
                                <option value="yamunanagar">Yamunanagar</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="block">Which block is it in? *</label>
                            <select id="block" name="block">
                                <option value="">First select a district</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="commercial-production-month">Month of Commercial Production for Unit *</label>
                            <input type="month" id="commercial-production-month" name="commercial-production-month">
                        </div>

                        <div class="form-group">
                            <label for="project-type">Project Type *</label>
                            <select id="project-type" name="project-type">
                                <option value="">Select Project Type</option>
                                <option value="new">New Unit</option>
                                <option value="expansion">Expansion in Existing Unit</option>
                                <option value="upgrade">Upgrade in Existing Unit</option>
                            </select>
                            <small>Select your project type</small>
                        </div>

                        <!-- Land Ownership Questions (only for new projects) -->
                        <div id="land-ownership-section" style="display: none;">
                            <div class="form-group">
                                <label for="land-ownership">Is your unit on own land or leased land? *</label>
                                <div class="radio-group">
                                    <label><input type="radio" name="land-ownership" value="own"> Own Land</label>
                                    <label><input type="radio" name="land-ownership" value="leased"> Leased Land</label>
                                </div>
                                <small>Select your land ownership type</small>
                            </div>

                            <!-- Own Land Questions -->
                            <div id="own-land-questions" style="display: none;">
                                <div class="form-group">
                                    <label for="land-purchase-month">Month and Year of Purchase *</label>
                                    <input type="month" id="land-purchase-month" name="land-purchase-month">
                                </div>

                                <div class="form-group">
                                    <label for="stamp-duty-paid">How Much Stamp Duty was Paid (INR Lakhs) *</label>
                                    <input type="number" id="stamp-duty-paid" name="stamp-duty-paid" step="0.01" min="0">
                                    <small>Amount paid as stamp duty during land purchase</small>
                                </div>
                            </div>

                            <!-- Leased Land Questions -->
                            <div id="leased-land-questions" style="display: none;">
                                <div class="form-group">
                                    <label for="monthly-rent">What is the Monthly Rent (INR Lakhs) *</label>
                                    <input type="number" id="monthly-rent" name="monthly-rent" step="0.01" min="0">
                                    <small>Monthly rent amount for leased land</small>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="machinery-investment">Machinery & Plant Setup (INR Lakhs) *</label>
                            <input type="number" id="machinery-investment" name="machinery-investment" step="0.01">
                            <small>Investment in plant and machinery</small>
                        </div>

                        <div class="form-group">
                            <label for="total-project-cost">Total Project Cost (INR Lakhs) *</label>
                            <input type="number" id="total-project-cost" name="total-project-cost" step="0.01">
                            <small>Total project cost (land + machinery + other expenses)</small>
                        </div>

                        <div class="form-group">
                            <label for="interest-rate">Interest Rate on Term Loan (%)</label>
                            <input type="number" id="interest-rate" name="interest-rate" step="0.1" min="0" max="20">
                            <small>Required for interest subsidy calculations</small>
                        </div>

                    </div>

                    <!-- Financial & Operational Details -->
                    <div class="form-section" style="display: none;">
                        <h3>Mention the actual costs incurred or planning to incur in FY25-26 for the below items</h3>
                        
                        <div class="form-group">
                            <label for="annual-electricity-consumption">Annual Electricity Consumption (Units)</label>
                            <input type="number" id="annual-electricity-consumption" name="annual-electricity-consumption" min="0">
                            <small>For electricity duty reimbursement</small>
                        </div>

                        <div class="form-group">
                            <label for="domestic-exhibition-cost">Cost of Costliest Domestic Exhibition attended (INR Lakhs)</label>
                            <input type="number" id="domestic-exhibition-cost" name="domestic-exhibition-cost" step="0.01" min="0">
                            <small>Cost of attending domestic exhibitions</small>
                        </div>

                        <div class="form-group">
                            <label for="international-exhibition-cost">Cost of Costliest International Exhibition attended (INR Lakhs)</label>
                            <input type="number" id="international-exhibition-cost" name="international-exhibition-cost" step="0.01" min="0">
                            <small>Cost of attending international exhibitions</small>
                        </div>

                        <div class="form-group">
                            <label for="international-airfare">Cost of Air Fare for Attending above International Exhibition (INR Lakhs)</label>
                            <input type="number" id="international-airfare" name="international-airfare" step="0.01" min="0">
                            <small>Air fare cost for international exhibition</small>
                        </div>

                        <div class="form-group">
                            <label for="energy-audit-cost">Cost of Energy Audit (INR Lakhs)</label>
                            <input type="number" id="energy-audit-cost" name="energy-audit-cost" step="0.01" min="0">
                            <small>Cost of energy audit services</small>
                        </div>

                        <div class="form-group">
                            <label for="water-conservation-audit-cost">Cost of Water Conservation Audit (INR Lakhs)</label>
                            <input type="number" id="water-conservation-audit-cost" name="water-conservation-audit-cost" step="0.01" min="0">
                            <small>Cost of water conservation audit</small>
                        </div>

                        <div class="form-group">
                            <label for="energy-efficient-equipment-cost">Cost of Energy Efficient Equipment (INR Lakhs)</label>
                            <input type="number" id="energy-efficient-equipment-cost" name="energy-efficient-equipment-cost" step="0.01" min="0">
                            <small>Cost of energy efficient equipment</small>
                        </div>

                        <div class="form-group">
                            <label for="quality-certification-cost">Cost of Quality Certifications (INR Lakhs)</label>
                            <input type="number" id="quality-certification-cost" name="quality-certification-cost" step="0.01" min="0">
                            <small>Cost of quality certifications</small>
                        </div>

                        <div class="form-group">
                            <label for="erp-implementation-cost">Cost of ERP Implementation & Management (INR Lakhs)</label>
                            <input type="number" id="erp-implementation-cost" name="erp-implementation-cost" step="0.01" min="0">
                            <small>Cost of ERP implementation and management</small>
                        </div>

                        <div class="form-group">
                            <label for="testing-measuring-equipment-cost">Cost of Testing & Measuring Equipments (INR Lakhs)</label>
                            <input type="number" id="testing-measuring-equipment-cost" name="testing-measuring-equipment-cost" step="0.01" min="0">
                            <small>Cost of testing and measuring equipment</small>
                        </div>

                        <div class="form-group">
                            <label for="barcoding-implementation-cost">Cost of Implementing Barcoding (INR Lakhs)</label>
                            <input type="number" id="barcoding-implementation-cost" name="barcoding-implementation-cost" step="0.01" min="0">
                            <small>Cost of implementing barcoding system</small>
                        </div>

                        <div class="form-group">
                            <label for="international-patent-filing-cost">Cost of International Patent Filing (INR Lakhs)</label>
                            <input type="number" id="international-patent-filing-cost" name="international-patent-filing-cost" step="0.01" min="0">
                            <small>Cost of international patent filing</small>
                        </div>

                        <div class="form-group">
                            <label for="national-patent-filing-cost">Cost of National Patent Filing (INR Lakhs)</label>
                            <input type="number" id="national-patent-filing-cost" name="national-patent-filing-cost" step="0.01" min="0">
                            <small>Cost of national patent filing</small>
                        </div>

                        <div class="form-group">
                            <label for="copyright-trademark-filing-cost">Cost of Copyright & Trademark Filing (INR Lakhs)</label>
                            <input type="number" id="copyright-trademark-filing-cost" name="copyright-trademark-filing-cost" step="0.01" min="0">
                            <small>Cost of copyright and trademark filing</small>
                        </div>

                        <div class="form-group">
                            <label for="haryana-domicile-employees">How many employees of Haryana Domicile under the salary of Rs. 40k/month</label>
                            <input type="number" id="haryana-domicile-employees" name="haryana-domicile-employees" min="0">
                            <small>Number of Haryana domicile employees with salary under Rs. 40k/month</small>
                        </div>

                        <div class="form-group">
                            <label for="apprentices">Number of Apprentices under NAPS/NATS</label>
                            <input type="number" id="apprentices" name="apprentices" min="0">
                            <small>Number of apprentices enrolled under National Apprenticeship Promotion Scheme</small>
                        </div>

                        <div class="form-group">
                            <label for="safety-audit-cost">Cost of Safety Audit (INR Lakhs)</label>
                            <input type="number" id="safety-audit-cost" name="safety-audit-cost" step="0.01" min="0">
                            <small>Cost of safety audit services</small>
                        </div>

                        <div class="form-group">
                            <label for="safety-equipment-cost">Cost of Safety Equipment (INR Lakhs)</label>
                            <input type="number" id="safety-equipment-cost" name="safety-equipment-cost" step="0.01" min="0">
                            <small>Cost of safety equipment and PPE</small>
                        </div>

                        <div class="form-group">
                            <label for="etp-plant-cost">Cost of ETP Plant Installation (INR Lakhs)</label>
                            <input type="number" id="etp-plant-cost" name="etp-plant-cost" step="0.01" min="0">
                            <small>Cost of Effluent Treatment Plant installation</small>
                        </div>

                        <div class="form-group">
                            <label for="rooftop-solar-cost">Cost of Rooftop Solar Installation (INR Lakhs)</label>
                            <input type="number" id="rooftop-solar-cost" name="rooftop-solar-cost" step="0.01" min="0">
                            <small>Cost of rooftop solar panel installation</small>
                        </div>

                        <div class="form-group">
                            <label for="zero-liquid-discharge-cost">Cost of Zero Liquid Discharge System (INR Lakhs)</label>
                            <input type="number" id="zero-liquid-discharge-cost" name="zero-liquid-discharge-cost" step="0.01" min="0">
                            <small>Cost of Zero Liquid Discharge (ZLD) system</small>
                        </div>

                        <div class="form-group">
                            <label for="equity-investment">Equity Investment Amount Sought (INR Lakhs)</label>
                            <input type="number" id="equity-investment" name="equity-investment" step="0.01" min="0">
                            <small>Amount of equity investment you are seeking</small>
                        </div>

                        <div class="form-group">
                            <label for="branding-marketing-cost">Annual Branding & Marketing Cost (INR Lakhs)</label>
                            <input type="number" id="branding-marketing-cost" name="branding-marketing-cost" step="0.01" min="0">
                            <small>Annual expenditure on branding and marketing</small>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn--primary">Check Eligibility</button>
                    </div>
                </form>

                <!-- Results Section -->
                <div id="eligibility-results" style="display: none;">
                    <div id="results-content"></div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer" id="footer"></footer>

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/auth-service.js"></script>
    <script src="js/auth-flow.js"></script>
    <script src="js/components.js"></script>
    <script src="js/main.js"></script>
    
    <script>
        // Initialize page after all scripts are loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize any page-specific functionality here
        });
    </script>
    
    <script>

        // Calendar field click handlers
        function initCalendarFields() {
            const calendarFields = document.querySelectorAll('input[type="month"]');
            calendarFields.forEach(field => {
                // Add click event to the entire field
                field.addEventListener('click', function(e) {
                    // Prevent default to avoid double-triggering
                    e.preventDefault();
                    // Focus the field to open the calendar
                    this.focus();
                    // Trigger the native calendar picker
                    this.showPicker();
                });
                
                // Also handle focus to ensure calendar opens
                field.addEventListener('focus', function() {
                    // Small delay to ensure the field is properly focused
                    setTimeout(() => {
                        if (this.showPicker) {
                            this.showPicker();
                        }
                    }, 100);
                });
            });
        }

        // Initialize calendar fields when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM Content Loaded');
            initCalendarFields();
            initProjectTypeLogic();
        });

        // Project type logic for conditional land ownership questions
        function initProjectTypeLogic() {
            const projectTypeSelect = document.getElementById('project-type');
            const landOwnershipSection = document.getElementById('land-ownership-section');
            
            if (projectTypeSelect) {
                projectTypeSelect.addEventListener('change', function() {
                    if (this.value === 'new') {
                        landOwnershipSection.style.display = 'block';
                    } else {
                        landOwnershipSection.style.display = 'none';
                        // Reset land ownership radio buttons when hidden
                        const landOwnershipRadios = document.querySelectorAll('input[name="land-ownership"]');
                        landOwnershipRadios.forEach(radio => radio.checked = false);
                        // Hide conditional questions
                        document.getElementById('own-land-questions').style.display = 'none';
                        document.getElementById('leased-land-questions').style.display = 'none';
                    }
                });
            }
        }

        // Initialize the eligibility questionnaire on page load

        // AI Integration for Eligibility Check
        async function processEligibilityCheck(formData) {
            const API_BASE_URL = 'http://localhost:8001'; // Update with your backend URL
            const sessionId = 'eligibility_' + Date.now();
            
            try {
                console.log('Submitting eligibility check to AI...');
                
                const response = await fetch(`${API_BASE_URL}/eligibility-check`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Session-Id': sessionId
                    },
                    body: JSON.stringify(formData)
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                console.log('AI Eligibility Analysis:', result);
                
                // Display results to user
                displayEligibilityResults(result);
                
                return result;
                
            } catch (error) {
                console.error('Error processing eligibility check:', error);
                console.error('Error details:', {
                    message: error.message,
                    stack: error.stack,
                    name: error.name
                });
                
                // Restore button state
                const submitBtn = document.querySelector('button[type="submit"]');
                if (submitBtn && submitBtn.dataset.originalText) {
                    submitBtn.textContent = submitBtn.dataset.originalText;
                    submitBtn.disabled = false;
                }
                
                alert(`Sorry, there was an error processing your eligibility check: ${error.message}. Please try again.`);
                return null;
            }
        }

        function displayEligibilityResults(results) {
            // Hide the form
            document.getElementById('eligibility-modal').style.display = 'none';
            
            // Hide any static content that might interfere
            const staticElements = [
                '.hero',
                '.flow-map', 
                '.eligibility-hero',
                '.static-content'
            ];
            
            staticElements.forEach(selector => {
                const elements = document.querySelectorAll(selector);
                elements.forEach(el => el.style.display = 'none');
            });
            
            // Create results section
            const resultsSection = document.createElement('div');
            resultsSection.id = 'eligibility-results';
            resultsSection.innerHTML = `
                <div class="eligibility-results-container">
                    <h2>ðŸŽ¯ Your Eligibility Analysis</h2>
                    <div class="results-summary">
                        <h3>Total Estimated Benefits: ${results.total_estimated_benefits}</h3>
                        ${results.benefit_breakdown ? `
                        <div class="benefit-breakdown">
                            <h4>Benefit Breakdown:</h4>
                            <div class="breakdown-grid">
                                <div class="breakdown-item">
                                    <span class="breakdown-label">Direct Incentives:</span>
                                    <span class="breakdown-amount">${results.benefit_breakdown.direct_incentives || 'â‚¹0 Lakhs'}</span>
                                </div>
                                <div class="breakdown-item">
                                    <span class="breakdown-label">Interest Subsidies:</span>
                                    <span class="breakdown-amount">${results.benefit_breakdown.interest_subsidies || 'â‚¹0 Lakhs'}</span>
                                </div>
                                <div class="breakdown-item">
                                    <span class="breakdown-label">Loan Guarantees:</span>
                                    <span class="breakdown-amount">${results.benefit_breakdown.loan_guarantees || 'â‚¹0 Lakhs'}</span>
                                </div>
                            </div>
                        </div>
                        ` : ''}
                    </div>
                    
                    <div class="eligible-schemes">
                        <h3>${results.company_name || 'Your Company'} is eligible for ${results.eligible_schemes.length} schemes</h3>
                        
                        ${results.eligible_schemes.map((scheme, index) => `
                            <div class="scheme-card">
                                <h4>${scheme.name}</h4>
                                <p class="benefit-amount">${scheme.benefit_amount}</p>
                                ${scheme.benefit_type ? `<p class="benefit-type">Type: ${scheme.benefit_type}</p>` : ''}
                                <p class="eligibility-score">Eligibility: ${scheme.eligibility_score}</p>
                                <p class="description">${scheme.description}</p>
                                <div class="requirements">
                                    <strong>Requirements:</strong>
                                    <ul>
                                        ${scheme.requirements.map(req => `<li>${req}</li>`).join('')}
                                    </ul>
                                </div>
                                <button class="btn btn--primary" onclick="selectScheme('${scheme.name}')">
                                    Apply for this Scheme
                                </button>
                            </div>
                            
                            ${index === 2 ? `
                            <!-- Sales Nudge - Strategic Placement After 3 Cards -->
                            <div class="sales-nudge">
                                <div class="discount-badge">
                                    <span class="discount-text">ðŸŽ‰ Yay! Discount Unlocked!</span>
                                </div>
                                <div class="pricing-info">
                                    <span class="original-price">â‚¹49,995</span>
                                    <span class="current-price">â‚¹19,998</span>
                                    <span class="savings">Save â‚¹30,000!</span>
                                </div>
                                <div class="offer-details">
                                    Apply to 5 schemes for <strong>â‚¹19,998/-</strong> (Actual Price: â‚¹49,995)
                                </div>
                            </div>
                            ` : ''}
                        `).join('')}
                    </div>
                    
                    <div class="recommended-actions">
                        <h3>Recommended Next Steps:</h3>
                        <ul>
                            ${results.recommended_actions.map(action => `<li>${action}</li>`).join('')}
                        </ul>
                    </div>
                    
                    <div class="cta-section">
                        <button class="btn btn--secondary" onclick="startChatWithAI()">
                            ðŸ’¬ Chat with AI Assistant
                        </button>
                        <button class="btn btn--primary" onclick="scheduleConsultation()">
                            ðŸ“ž Schedule Free Consultation
                        </button>
                    </div>
                </div>
            `;
            
            // Insert results at the top of the main content area (independent of any static content)
            const mainContent = document.querySelector('.eligibility-main') || 
                              document.querySelector('main') || 
                              document.querySelector('.container') ||
                              document.body;
            
            if (mainContent) {
                // Insert at the beginning of main content for better visibility
                mainContent.insertBefore(resultsSection, mainContent.firstChild);
            } else {
                document.body.appendChild(resultsSection);
            }
            
            // Scroll to results
            resultsSection.scrollIntoView({ behavior: 'smooth' });
        }

        function selectScheme(schemeName) {
            alert(`Great choice! You've selected: ${schemeName}\n\nOur team will contact you to help with the application process.`);
        }

        function startChatWithAI() {
            // Redirect to chatbot or open in new tab
            window.open('/schemes-chatbot', '_blank');
        }

        function scheduleConsultation() {
            alert('ðŸ“ž Consultation Request Sent!\n\nOur team will contact you within 24 hours to schedule your free consultation.');
        }

        // Update form submission to use AI
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.querySelector('.questionnaire-form');
            if (form) {
                form.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    // Collect form data
                    const formData = new FormData(form);
                    const data = Object.fromEntries(formData.entries());
                    
                    console.log('Form submitted with data:', data);
                    
                    // Show loading state
                    const submitBtn = form.querySelector('button[type="submit"]');
                    if (submitBtn) {
                        const originalText = submitBtn.textContent;
                        submitBtn.textContent = 'Processing with AI...';
                        submitBtn.disabled = true;
                        
                        // Store original text for restoration
                        submitBtn.dataset.originalText = originalText;
                    }
                    
                    // Process with AI
                    await processEligibilityCheck(data);
                });
            }
        });
    </script>
</body>
</html>